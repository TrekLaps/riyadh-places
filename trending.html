<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ù‡Ø§Ø¨Ù‘ Ø§Ù„Ø­ÙŠÙ† ğŸ”¥ - Ø§Ù„Ø£Ù…Ø§ÙƒÙ† Ø§Ù„Ø£ÙƒØ«Ø± Ø§Ø²Ø¯Ø­Ø§Ù…Ø§Ù‹ Ø§Ù„Ø¢Ù† | ÙˆÙŠÙ† Ù†Ø±ÙˆØ­ Ø¨Ø§Ù„Ø±ÙŠØ§Ø¶ØŸ</title>
  <meta name="description" content="Ø§ÙƒØªØ´Ù Ø§Ù„Ø£Ù…Ø§ÙƒÙ† Ø§Ù„Ø£ÙƒØ«Ø± Ø§Ø²Ø¯Ø­Ø§Ù…Ø§Ù‹ ÙÙŠ Ø§Ù„Ø±ÙŠØ§Ø¶ Ø§Ù„Ø­ÙŠÙ†! ØªØ§Ø¨Ø¹ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø§Ø²Ø¯Ø­Ø§Ù… ÙÙŠ Ø§Ù„ÙƒØ§ÙÙŠÙ‡Ø§Øª ÙˆØ§Ù„Ù…Ø·Ø§Ø¹Ù… ÙˆØ§Ù„Ø£Ù…Ø§ÙƒÙ† Ø§Ù„ØªØ±ÙÙŠÙ‡ÙŠØ© Ù„Ø­Ø¸Ø© Ø¨Ù„Ø­Ø¸Ø©.">
  <meta name="keywords" content="Ø£Ù…Ø§ÙƒÙ† Ù…Ø²Ø¯Ø­Ù…Ø© Ø§Ù„Ø±ÙŠØ§Ø¶, Ø§Ù„Ø£Ù…Ø§ÙƒÙ† Ø§Ù„Ø±Ø§Ø¦Ø¬Ø© Ø§Ù„Ø±ÙŠØ§Ø¶, Ø§Ø²Ø¯Ø­Ø§Ù… ÙƒØ§ÙÙŠÙ‡Ø§Øª Ø§Ù„Ø±ÙŠØ§Ø¶, popular times riyadh">
  <meta name="robots" content="index, follow">
  <link rel="canonical" href="https://wain-nrooh.com/trending.html">
  <meta property="og:type" content="website">
  <meta property="og:title" content="Ù‡Ø§Ø¨Ù‘ Ø§Ù„Ø­ÙŠÙ† ğŸ”¥ - Ø£Ù…Ø§ÙƒÙ† Ø§Ù„Ø±ÙŠØ§Ø¶ Ø§Ù„Ø±Ø§Ø¦Ø¬Ø© Ø§Ù„Ø¢Ù†">
  <meta property="og:description" content="Ø´ÙˆÙ ÙˆØ´ Ø§Ù„Ø£Ù…Ø§ÙƒÙ† Ø§Ù„Ù„ÙŠ Ù‡Ø§Ø¨Ù‘Ø© Ø§Ù„Ø­ÙŠÙ† Ø¨Ø§Ù„Ø±ÙŠØ§Ø¶! Ø§Ø²Ø¯Ø­Ø§Ù… Ù„Ø­Ø¸ÙŠ Ù„ÙƒÙ„ Ù…ÙƒØ§Ù†.">
  <meta property="og:url" content="https://wain-nrooh.com/trending.html">
  <meta property="og:locale" content="ar_SA">
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#0a1628">
  <link rel="stylesheet" href="css/style.css">
</head>
<body>

  <header class="header">
    <div class="header-inner">
      <a href="index.html" class="logo"><span>ğŸ™ï¸</span><h1>ÙˆÙŠÙ† Ù†Ø±ÙˆØ­ Ø¨Ø§Ù„Ø±ÙŠØ§Ø¶ØŸ</h1></a>
      <button class="menu-toggle" aria-label="Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©">â˜°</button>
      <nav class="nav">
        <a href="index.html">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
        <a href="cafes.html">ÙƒØ§ÙÙŠÙ‡Ø§Øª</a>
        <a href="restaurants.html">Ù…Ø·Ø§Ø¹Ù…</a>
        <a href="activities.html">ØªØ±ÙÙŠÙ‡</a>
        <a href="events.html">ÙØ¹Ø§Ù„ÙŠØ§Øª</a>
        <a href="new-places.html">Ø¬Ø¯ÙŠØ¯</a>
        <a href="discover.html">ğŸ² ÙˆÙŠÙ† Ù†Ø±ÙˆØ­ØŸ</a>
        <div class="nav-dropdown">
          <a href="#">Ø§Ù„Ù…Ø²ÙŠØ¯</a>
          <div class="dropdown-menu">
            <a href="shopping.html">ğŸ›ï¸ ØªØ³ÙˆÙ‚</a>
            <a href="nature.html">ğŸï¸ Ø·Ø¨ÙŠØ¹Ø©</a>
            <a href="desserts.html">ğŸ° Ø­Ù„ÙˆÙŠØ§Øª</a>
            <a href="top-rated.html">â­ Ø§Ù„Ø£Ø¹Ù„Ù‰ ØªÙ‚ÙŠÙŠÙ…Ø§Ù‹</a>
            <div class="dropdown-divider"></div>
            <a href="neighborhoods.html">ğŸ˜ï¸ Ø£Ø­ÙŠØ§Ø¡ Ø§Ù„Ø±ÙŠØ§Ø¶</a>
            <a href="foundation-day.html">ğŸ‡¸ğŸ‡¦ ÙŠÙˆÙ… Ø§Ù„ØªØ£Ø³ÙŠØ³</a>
            <a href="riyadh-season.html">âœ¨ Ù…ÙˆØ³Ù… Ø§Ù„Ø±ÙŠØ§Ø¶</a>
            <div class="dropdown-divider"></div>
            <div class="dropdown-submenu">
              <a href="#">ğŸ˜ï¸ Ø§Ù„Ø£Ø­ÙŠØ§Ø¡</a>
              <div class="submenu">
                <a href="neighborhood-olaya.html">Ø­ÙŠ Ø§Ù„Ø¹Ù„ÙŠØ§</a>
                <a href="neighborhood-malqa.html">Ø­ÙŠ Ø§Ù„Ù…Ù„Ù‚Ø§</a>
                <a href="neighborhood-hittin.html">Ø­ÙŠ Ø­Ø·ÙŠÙ†</a>
                <a href="neighborhood-yasmin.html">Ø­ÙŠ Ø§Ù„ÙŠØ§Ø³Ù…ÙŠÙ†</a>
                <a href="neighborhood-rabee.html">Ø­ÙŠ Ø§Ù„Ø±Ø¨ÙŠØ¹</a>
                <a href="neighborhood-narjis.html">Ø­ÙŠ Ø§Ù„Ù†Ø±Ø¬Ø³</a>
                <a href="neighborhood-wurud.html">Ø­ÙŠ Ø§Ù„ÙˆØ±ÙˆØ¯</a>
                <a href="neighborhood-sahafa.html">Ø­ÙŠ Ø§Ù„ØµØ­Ø§ÙØ©</a>
                <a href="neighborhood-muruj.html">Ø­ÙŠ Ø§Ù„Ù…Ø±ÙˆØ¬</a>
                <a href="neighborhood-nakheel.html">Ø­ÙŠ Ø§Ù„Ù†Ø®ÙŠÙ„</a>
                <a href="neighborhood-diriyah.html">Ø§Ù„Ø¯Ø±Ø¹ÙŠØ©</a>
                <a href="neighborhood-kafd.html">KAFD</a>
                <a href="neighborhood-safarat.html">Ø­ÙŠ Ø§Ù„Ø³ÙØ§Ø±Ø§Øª</a>
                <a href="neighborhood-malz.html">Ø­ÙŠ Ø§Ù„Ù…Ù„Ø²</a>
                <a href="neighborhood-aqiq.html">Ø­ÙŠ Ø§Ù„Ø¹Ù‚ÙŠÙ‚</a>
                <a href="neighborhood-sulaymaniyah.html">Ø­ÙŠ Ø§Ù„Ø³Ù„ÙŠÙ…Ø§Ù†ÙŠØ©</a>
                <a href="neighborhood-gharnata.html">ØºØ±Ù†Ø§Ø·Ø©</a>
                <a href="neighborhood-rabwa.html">Ø­ÙŠ Ø§Ù„Ø±Ø¨ÙˆØ©</a>
                <a href="neighborhood-arid.html">Ø­ÙŠ Ø§Ù„Ø¹Ø§Ø±Ø¶</a>
                <a href="neighborhood-ghdir.html">Ø­ÙŠ Ø§Ù„ØºØ¯ÙŠØ±</a>
              </div>
            </div>
          </div>
        </div>
      </nav>
    </div>
  </header>

  <section class="page-header">
    <h2>ğŸ”¥ Ù‡Ø§Ø¨Ù‘ <span>Ø§Ù„Ø­ÙŠÙ†</span></h2>
    <p>Ø§Ù„Ø£Ù…Ø§ÙƒÙ† Ø§Ù„Ø£ÙƒØ«Ø± Ø§Ø²Ø¯Ø­Ø§Ù…Ø§Ù‹ ÙÙŠ Ø§Ù„Ø±ÙŠØ§Ø¶ Ù‡Ø°ÙŠ Ø§Ù„Ù„Ø­Ø¸Ø© â€” Ù…Ø­Ø¯Ø« ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø­Ø³Ø¨ Ø§Ù„ÙˆÙ‚Øª</p>
  </section>

  <div class="breadcrumb">
    <a href="index.html">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a> <span>â€º</span> Ù‡Ø§Ø¨Ù‘ Ø§Ù„Ø­ÙŠÙ† ğŸ”¥
  </div>

  <div style="max-width: var(--max-width, 1200px); margin: 20px auto; padding: 0 20px;">
    <!-- Live Status Banner -->
    <div id="live-status" class="live-status-banner">
      <div class="live-dot"></div>
      <span id="live-time">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</span>
    </div>

    <!-- Category Filter -->
    <div class="filter-tabs" id="category-filters">
      <button class="filter-tab active" data-cat="all">ğŸ™ï¸ Ø§Ù„ÙƒÙ„</button>
      <button class="filter-tab" data-cat="cafe">â˜• ÙƒØ§ÙÙŠÙ‡Ø§Øª</button>
      <button class="filter-tab" data-cat="restaurant">ğŸ½ï¸ Ù…Ø·Ø§Ø¹Ù…</button>
      <button class="filter-tab" data-cat="activity">ğŸ­ ØªØ±ÙÙŠÙ‡</button>
      <button class="filter-tab" data-cat="shopping">ğŸ›ï¸ ØªØ³ÙˆÙ‚</button>
      <button class="filter-tab" data-cat="entertainment">ğŸ® Ø£Ù„Ø¹Ø§Ø¨</button>
      <button class="filter-tab" data-cat="nature">ğŸï¸ Ø·Ø¨ÙŠØ¹Ø©</button>
      <button class="filter-tab" data-cat="desserts">ğŸ° Ø­Ù„ÙˆÙŠØ§Øª</button>
      <button class="filter-tab" data-cat="events">ğŸª ÙØ¹Ø§Ù„ÙŠØ§Øª</button>
    </div>

    <!-- Results Count -->
    <div class="sort-filter-bar" style="margin-bottom: 20px;">
      <div class="results-count" id="results-count">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
      <div class="sort-filter-controls">
        <select class="sort-select" id="busyness-filter">
          <option value="all">ÙƒÙ„ Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª</option>
          <option value="very_busy">ğŸ”´ Ù…Ø²Ø¯Ø­Ù… Ø¬Ø¯Ø§Ù‹</option>
          <option value="busy">ğŸ”´ Ù…Ø²Ø¯Ø­Ù…</option>
          <option value="moderate">ğŸŸ¡ Ù…Ø¹ØªØ¯Ù„</option>
          <option value="quiet">ğŸŸ¢ Ù‡Ø§Ø¯ÙŠ</option>
        </select>
      </div>
    </div>

    <!-- Trending Grid -->
    <div id="trending-container" class="cards-grid"></div>
  </div>

  <footer class="footer">
    <div class="footer-inner">
      <div>
        <h3>ÙˆÙŠÙ† Ù†Ø±ÙˆØ­ Ø¨Ø§Ù„Ø±ÙŠØ§Ø¶ØŸ</h3>
        <p>Ø¯Ù„ÙŠÙ„Ùƒ Ø§Ù„Ø´Ø§Ù…Ù„ Ù„Ø£ÙØ¶Ù„ Ø§Ù„Ø£Ù…Ø§ÙƒÙ† ÙÙŠ Ø§Ù„Ø±ÙŠØ§Ø¶ Ù…Ø¹ ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ù‚ÙˆÙ‚Ù„ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©. Ù…Ø­Ø¯Ø« ÙŠÙˆÙ…ÙŠØ§Ù‹ Ø¨Ø£Ø­Ø¯Ø« Ø§Ù„Ø£Ù…Ø§ÙƒÙ† ÙˆØ§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª.</p>
      </div>
      <div>
        <h3>Ø§Ù„Ø£Ù‚Ø³Ø§Ù…</h3>
        <ul>
          <li><a href="cafes.html">ÙƒØ§ÙÙŠÙ‡Ø§Øª Ø§Ù„Ø±ÙŠØ§Ø¶</a></li>
          <li><a href="restaurants.html">Ù…Ø·Ø§Ø¹Ù… Ø§Ù„Ø±ÙŠØ§Ø¶</a></li>
          <li><a href="activities.html">ØªØ±ÙÙŠÙ‡ ÙˆØ£Ù†Ø´Ø·Ø©</a></li>
          <li><a href="shopping.html">ØªØ³ÙˆÙ‚ Ø¨Ø§Ù„Ø±ÙŠØ§Ø¶</a></li>
          <li><a href="nature.html">Ø·Ø¨ÙŠØ¹Ø© ÙˆØ±Ø­Ù„Ø§Øª</a></li>
          <li><a href="desserts.html">Ø­Ù„ÙˆÙŠØ§Øª Ø§Ù„Ø±ÙŠØ§Ø¶</a></li>
          <li><a href="events.html">ÙØ¹Ø§Ù„ÙŠØ§Øª Ø§Ù„Ø±ÙŠØ§Ø¶</a></li>
          <li><a href="trending.html">Ù‡Ø§Ø¨Ù‘ Ø§Ù„Ø­ÙŠÙ† ğŸ”¥</a></li>
          <li><a href="top-rated.html">Ø§Ù„Ø£Ø¹Ù„Ù‰ ØªÙ‚ÙŠÙŠÙ…Ø§Ù‹</a></li>
          <li><a href="new-places.html">Ø£Ù…Ø§ÙƒÙ† Ø¬Ø¯ÙŠØ¯Ø©</a>
        <a href="map.html">ğŸ—ºï¸ Ø§Ù„Ø®Ø±ÙŠØ·Ø©</a>
        <a href="favorites.html">â¤ï¸ Ø§Ù„Ù…ÙØ¶Ù„Ø©</a></li>
        </ul>
      </div>
      <div>
        <h3>Ø±ÙˆØ§Ø¨Ø· Ù…ÙÙŠØ¯Ø©</h3>
        <ul>
          <li><a href="sitemap.xml">Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹</a></li>
          <li><a href="#">Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©</a></li>
          <li><a href="#">ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§</a></li>
        </ul>
      </div>
    </div>
    <div class="footer-heart">ØµÙ†Ø¹ Ø¨Ù€ <span>â¤ï¸</span> ÙÙŠ Ø§Ù„Ø±ÙŠØ§Ø¶</div>
    <div class="footer-bottom"><p>Â© 2025-2026 ÙˆÙŠÙ† Ù†Ø±ÙˆØ­ Ø¨Ø§Ù„Ø±ÙŠØ§Ø¶ØŸ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.</p></div>
  </footer>

  <button class="scroll-top" id="scrollTop" aria-label="Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø£Ø¹Ù„Ù‰">â†‘</button>

  <style>
    .live-status-banner {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 14px 20px;
      background: linear-gradient(135deg, var(--primary), var(--primary-light));
      color: white;
      border-radius: var(--radius);
      margin-bottom: 20px;
      font-size: 15px;
      font-weight: 600;
    }
    .live-dot {
      width: 10px;
      height: 10px;
      background: #2ecc71;
      border-radius: 50%;
      animation: pulse 1.5s infinite;
      flex-shrink: 0;
    }
    @keyframes pulse {
      0%, 100% { opacity: 1; box-shadow: 0 0 0 0 rgba(46,204,113,0.4); }
      50% { opacity: 0.7; box-shadow: 0 0 0 8px rgba(46,204,113,0); }
    }

    .trending-card-image {
      width: 100%;
      height: 160px;
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
      position: relative;
      overflow: hidden;
    }
    .trending-card-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .trending-card-image .rank-overlay {
      position: absolute;
      top: 10px;
      right: 10px;
      width: 36px;
      height: 36px;
      background: linear-gradient(135deg, var(--gold), var(--gold-dark));
      color: var(--primary);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
      font-weight: 900;
      box-shadow: 0 2px 8px rgba(0,0,0,0.3);
    }
    .trending-card-image .rank-overlay.rank-1 { background: linear-gradient(135deg, #FFD700, #FFA500); }
    .trending-card-image .rank-overlay.rank-2 { background: linear-gradient(135deg, #C0C0C0, #A0A0A0); }
    .trending-card-image .rank-overlay.rank-3 { background: linear-gradient(135deg, #CD7F32, #A0522D); color: #fff; }
    .trending-card-image .busyness-overlay {
      position: absolute;
      bottom: 10px;
      left: 10px;
      padding: 5px 12px;
      border-radius: 8px;
      font-size: 13px;
      font-weight: 700;
      backdrop-filter: blur(6px);
    }
    .busyness-bg-quiet { background: rgba(46,204,113,0.85); color: #fff; }
    .busyness-bg-moderate { background: rgba(243,156,18,0.85); color: #fff; }
    .busyness-bg-busy { background: rgba(231,76,60,0.85); color: #fff; }
    .busyness-bg-very_busy { background: rgba(192,57,43,0.9); color: #fff; }
    .busyness-bg-closed { background: rgba(100,100,100,0.85); color: #fff; }

    .trending-card-content {
      padding: 14px 16px 16px;
    }
    .trending-card-content .category-badge {
      display: inline-block;
      background: rgba(10,22,40,0.06);
      color: var(--primary);
      padding: 3px 10px;
      border-radius: 6px;
      font-size: 12px;
      font-weight: 600;
      margin-bottom: 4px;
    }
    .trending-card-content h3 {
      font-size: 17px;
      font-weight: 700;
      color: var(--primary);
      margin: 4px 0;
    }
    .trending-card-content .neighborhood {
      color: var(--text-muted);
      font-size: 13px;
      margin-bottom: 6px;
    }
    .trending-card-content .neighborhood::before { content: "ğŸ“ "; }

    .busyness-progress {
      display: flex;
      align-items: center;
      gap: 8px;
      margin: 10px 0;
    }
    .busyness-progress .bar-track {
      flex: 1;
      height: 8px;
      background: var(--border);
      border-radius: 4px;
      overflow: hidden;
    }
    .busyness-progress .bar-fill {
      height: 100%;
      border-radius: 4px;
      transition: width 0.6s ease;
    }
    .busyness-progress .bar-pct {
      font-size: 14px;
      font-weight: 800;
      min-width: 40px;
      text-align: center;
    }

    .trending-card-content .card-actions {
      display: flex;
      gap: 8px;
      margin-top: 12px;
    }

    .trending-card-content .rating-line {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 13px;
      color: var(--text-light);
      margin-bottom: 4px;
    }
    .trending-card-content .rating-line .stars { color: var(--gold); }

    /* No results */
    .trending-empty {
      text-align: center;
      padding: 60px 20px;
      color: var(--text-muted);
    }
    .trending-empty .emoji { font-size: 64px; margin-bottom: 16px; }
    .trending-empty h3 { font-size: 20px; color: var(--text); margin-bottom: 8px; }
  </style>

  <script src="js/main.js"></script>
  <script src="js/crowd.js"></script>
  <script>
    const catIconMap = {
      'cafe': 'â˜•', 'restaurant': 'ğŸ½ï¸', 'activity': 'ğŸ­',
      'shopping': 'ğŸ›ï¸', 'nature': 'ğŸï¸', 'entertainment': 'ğŸ®',
      'desserts': 'ğŸ°', 'events': 'ğŸª'
    };
    const catNameMap = {
      'cafe': 'ÙƒØ§ÙÙŠÙ‡', 'restaurant': 'Ù…Ø·Ø¹Ù…', 'activity': 'ØªØ±ÙÙŠÙ‡',
      'shopping': 'ØªØ³ÙˆÙ‚', 'nature': 'Ø·Ø¨ÙŠØ¹Ø©', 'entertainment': 'Ø£Ù„Ø¹Ø§Ø¨',
      'desserts': 'Ø­Ù„ÙˆÙŠØ§Øª', 'events': 'ÙØ¹Ø§Ù„ÙŠØ§Øª'
    };

    let allPlaces = [];
    let currentCategory = 'all';
    let currentBusynessFilter = 'all';

    function updateLiveTime() {
      const now = new Date();
      const riyadh = new Date(now.getTime() + (3 * 60 * 60 * 1000));
      const h = riyadh.getUTCHours();
      const m = riyadh.getUTCMinutes();
      const ampm = h >= 12 ? 'Ù…' : 'Øµ';
      const dh = h > 12 ? h - 12 : (h === 0 ? 12 : h);
      const dayNames = ['Ø§Ù„Ø£Ø­Ø¯', 'Ø§Ù„Ø§Ø«Ù†ÙŠÙ†', 'Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡', 'Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡', 'Ø§Ù„Ø®Ù…ÙŠØ³', 'Ø§Ù„Ø¬Ù…Ø¹Ø©', 'Ø§Ù„Ø³Ø¨Øª'];
      const dayName = dayNames[riyadh.getUTCDay()];
      document.getElementById('live-time').textContent =
        `Ù…Ø¨Ø§Ø´Ø± Â· ${dayName} ${dh}:${String(m).padStart(2, '0')} ${ampm} Ø¨ØªÙˆÙ‚ÙŠØª Ø§Ù„Ø±ÙŠØ§Ø¶`;
    }

    function renderTrendingCard(place, rank) {
      const info = getBusynessLevel(place.currentBusyness);
      const rankClass = rank <= 3 ? `rank-${rank}` : '';
      const cat = place.category_en || place.category;

      return `
        <article class="trending-now-card" data-id="${place.id}">
          <div class="trending-card-image">
            ${place.image_url ? `<img src="${place.image_url}" alt="${place.name_ar}" loading="lazy" onerror="this.style.display='none'">` : ''}
            <div class="rank-overlay ${rankClass}">${rank}</div>
            <div class="busyness-overlay busyness-bg-${info.level}">${info.icon} ${info.label}</div>
          </div>
          <div class="trending-card-content">
            <span class="category-badge">${catIconMap[cat] || 'ğŸ“'} ${catNameMap[cat] || place.category}</span>
            <h3>${place.name_ar}</h3>
            <div class="neighborhood">${place.neighborhood}</div>
            <div class="rating-line">
              <span class="stars">${generateStars(place.google_rating)}</span>
              <span>${place.google_rating} Â· ${formatNumber(place.review_count)} ØªÙ‚ÙŠÙŠÙ…</span>
            </div>
            <div class="busyness-progress">
              <div class="bar-track">
                <div class="bar-fill" style="width: ${place.currentBusyness}%; background: ${info.color};"></div>
              </div>
              <span class="bar-pct" style="color: ${info.color}">${place.currentBusyness}%</span>
            </div>
            ${renderMiniChart(place)}
            <div class="card-actions">
              <a href="place.html?id=${place.id}" class="btn-primary">Ø§Ø¹Ø±Ù Ø£ÙƒØ«Ø±</a>
              <a href="${place.google_maps_url}" target="_blank" class="btn-outline">ğŸ“ Ø§Ù„Ù…ÙˆÙ‚Ø¹</a>
            </div>
          </div>
        </article>
      `;
    }

    function renderTrending() {
      const container = document.getElementById('trending-container');
      const day = getCurrentDay();
      const hour = getCurrentHour();

      let filtered = allPlaces
        .filter(p => p.popular_times && p.popular_times[day])
        .map(p => {
          const value = p.popular_times[day][hour] || 0;
          return { ...p, currentBusyness: value, busynessInfo: getBusynessLevel(value) };
        })
        .filter(p => p.currentBusyness > 0);

      // Category filter
      if (currentCategory !== 'all') {
        filtered = filtered.filter(p => {
          const cat = p.category_en || p.category;
          return cat === currentCategory;
        });
      }

      // Busyness filter
      if (currentBusynessFilter !== 'all') {
        filtered = filtered.filter(p => p.busynessInfo.level === currentBusynessFilter);
      }

      // Sort by busyness
      filtered.sort((a, b) => b.currentBusyness - a.currentBusyness);

      // Update count
      document.getElementById('results-count').innerHTML = 
        `Ø¹Ø±Ø¶ <strong>${formatNumber(filtered.length)}</strong> Ù…ÙƒØ§Ù† Ù…Ø±ØªØ¨ Ø­Ø³Ø¨ Ø§Ù„Ø§Ø²Ø¯Ø­Ø§Ù…`;

      if (filtered.length === 0) {
        container.innerHTML = `
          <div class="trending-empty" style="grid-column: 1 / -1;">
            <div class="emoji">ğŸ˜´</div>
            <h3>Ù…Ø§ ÙÙŠ Ø£Ù…Ø§ÙƒÙ† Ù…Ø²Ø¯Ø­Ù…Ø© Ø§Ù„Ø­ÙŠÙ†</h3>
            <p>Ø¬Ø±Ø¨ ØªØºÙŠÙŠØ± Ø§Ù„ÙÙ„ØªØ± Ø£Ùˆ ØªØ¹Ø§Ù„ ÙˆÙ‚Øª Ø«Ø§Ù†ÙŠ</p>
          </div>
        `;
        return;
      }

      container.innerHTML = filtered.map((p, i) => renderTrendingCard(p, i + 1)).join('');
    }

    document.addEventListener('DOMContentLoaded', async () => {
      allPlaces = await loadPlaces();
      
      updateLiveTime();
      setInterval(updateLiveTime, 30000);

      renderTrending();

      // Category filter tabs
      document.querySelectorAll('#category-filters .filter-tab').forEach(tab => {
        tab.addEventListener('click', () => {
          document.querySelectorAll('#category-filters .filter-tab').forEach(t => t.classList.remove('active'));
          tab.classList.add('active');
          currentCategory = tab.dataset.cat;
          renderTrending();
        });
      });

      // Busyness filter
      document.getElementById('busyness-filter').addEventListener('change', (e) => {
        currentBusynessFilter = e.target.value;
        renderTrending();
      });

      // Auto-refresh every 5 minutes
      setInterval(renderTrending, 5 * 60 * 1000);
    });
  </script>
  <script>
    document.querySelectorAll('.nav-dropdown > a').forEach(a => {
      a.addEventListener('click', (e) => {
        if (window.innerWidth <= 768) {
          e.preventDefault();
          a.parentElement.classList.toggle('open');
        }
      });
    });
    document.querySelectorAll('.dropdown-submenu > a').forEach(a => {
      a.addEventListener('click', (e) => {
        if (window.innerWidth <= 768) {
          e.preventDefault();
          a.nextElementSibling.style.display = a.nextElementSibling.style.display === 'block' ? 'none' : 'block';
        }
      });
    });
  </script>
  <script src="js/analytics.js"></script>
</body>
</html>
