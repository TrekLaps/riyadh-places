<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/svg+xml" href="images/icon-192.svg">
  <title>ğŸ”¥ Ø§Ù„Ø£Ù…Ø§ÙƒÙ† Ø§Ù„Ø±Ø§Ø¦Ø¬Ø© ÙÙŠ Ø§Ù„Ø±ÙŠØ§Ø¶ â€” Ø§Ù„Ø£ÙƒØ«Ø± Ø¨Ø­Ø«Ø§Ù‹ ÙˆØ²ÙŠØ§Ø±Ø© | ÙˆÙŠÙ† Ù†Ø±ÙˆØ­</title>
  <meta name="description" content="Ø§ÙƒØªØ´Ù Ø§Ù„Ø£Ù…Ø§ÙƒÙ† Ø§Ù„Ø±Ø§Ø¦Ø¬Ø© ÙˆØ§Ù„Ø£ÙƒØ«Ø± Ø¨Ø­Ø«Ø§Ù‹ ÙÙŠ Ø§Ù„Ø±ÙŠØ§Ø¶ Ø§Ù„Ø¢Ù†. Ù…Ø·Ø§Ø¹Ù…ØŒ ÙƒØ§ÙÙŠÙ‡Ø§ØªØŒ Ø£Ù…Ø§ÙƒÙ† ØªØ±ÙÙŠÙ‡ Ø¬Ø¯ÙŠØ¯Ø© ÙˆÙ…Ù…ÙŠØ²Ø©.">
  <meta name="keywords" content="Ø£Ù…Ø§ÙƒÙ† Ø±Ø§Ø¦Ø¬Ø© Ø§Ù„Ø±ÙŠØ§Ø¶, ØªØ±Ù†Ø¯ Ø§Ù„Ø±ÙŠØ§Ø¶, Ø£Ù…Ø§ÙƒÙ† Ø¬Ø¯ÙŠØ¯Ø©, Ø§Ù„Ø£ÙƒØ«Ø± Ø²ÙŠØ§Ø±Ø©">
  <link rel="canonical" href="https://treklaps.github.io/riyadh-places/trending.html">
  <meta property="og:title" content="ğŸ”¥ Ø§Ù„Ø£Ù…Ø§ÙƒÙ† Ø§Ù„Ø±Ø§Ø¦Ø¬Ø© ÙÙŠ Ø§Ù„Ø±ÙŠØ§Ø¶ â€” Ø§Ù„Ø£ÙƒØ«Ø± Ø¨Ø­Ø«Ø§Ù‹ ÙˆØ²ÙŠØ§Ø±Ø©">
  <meta name="twitter:card" content="summary_large_image">
  <meta property="og:description" content="Ø§ÙƒØªØ´Ù Ø§Ù„Ø£Ù…Ø§ÙƒÙ† Ø§Ù„Ø±Ø§Ø¦Ø¬Ø© ÙˆØ§Ù„Ø£ÙƒØ«Ø± Ø¨Ø­Ø«Ø§Ù‹ ÙÙŠ Ø§Ù„Ø±ÙŠØ§Ø¶ Ø§Ù„Ø¢Ù†">
  <meta property="og:url" content="https://treklaps.github.io/riyadh-places/trending.html">
  <meta property="og:locale" content="ar_SA">
  <meta property="og:image" content="https://treklaps.github.io/riyadh-places/images/icon-512.svg">
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#0a1628">
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
  <link rel="preload" href="data/places-light.json" as="fetch" crossorigin>
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:'Tajawal',sans-serif;background:#0a1628;color:#e0e0e0;direction:rtl;min-height:100vh}
    a{color:#c9a84c;text-decoration:none}
    .header{background:linear-gradient(135deg,#0a1628 0%,#1a2a4a 100%);padding:12px 20px;position:sticky;top:0;z-index:100;border-bottom:1px solid rgba(201,168,76,0.2)}
    .header-inner{display:flex;align-items:center;justify-content:space-between;max-width:1400px;margin:auto}
    .logo{text-decoration:none;color:#c9a84c;display:flex;align-items:center;gap:8px}
    .logo h1{font-size:1.2rem;margin:0}
    .back-link{color:#c9a84c;font-size:14px}
  </style>
  <link rel="stylesheet" href="css/style.css">
  <style>
    .hero{background:linear-gradient(135deg,#0a1628 0%,#2d1a0a 50%,#1a2d50 100%);padding:50px 20px 45px;text-align:center;position:relative}
    .hero::after{content:'';position:absolute;bottom:0;left:0;right:0;height:4px;background:linear-gradient(90deg,transparent,#f59e0b,transparent)}
    .hero h2{font-size:2rem;font-weight:900;margin-bottom:10px;color:#fff}
    .hero h2 span{color:#f59e0b}
    .hero p{color:rgba(255,255,255,0.7);font-size:16px;max-width:600px;margin:0 auto;line-height:1.8}
    .stats-bar{display:flex;gap:16px;justify-content:center;flex-wrap:wrap;margin-top:20px}
    .stat-item{background:rgba(245,158,11,0.1);border:1px solid rgba(245,158,11,0.2);border-radius:12px;padding:10px 18px;text-align:center}
    .stat-item .num{font-size:1.4rem;font-weight:900;color:#f59e0b}
    .stat-item .lbl{font-size:12px;color:rgba(255,255,255,0.6)}

    .container{max-width:1200px;margin:0 auto;padding:20px}
    .controls{display:flex;gap:12px;flex-wrap:wrap;align-items:center;margin-bottom:20px}
    .search-input{flex:1;min-width:200px;padding:12px 16px;border-radius:12px;border:1px solid rgba(245,158,11,0.3);background:#1c2333;color:#e0e0e0;font-family:inherit;font-size:15px}
    .search-input::placeholder{color:#666}
    .search-input:focus{outline:none;border-color:#f59e0b}
    select.filter-select{padding:12px 16px;border-radius:12px;border:1px solid rgba(245,158,11,0.3);background:#1c2333;color:#e0e0e0;font-family:inherit;font-size:14px}

    .filter-tags{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:20px}
    .filter-tag{padding:8px 16px;border-radius:20px;border:1px solid rgba(245,158,11,0.3);background:transparent;color:#f59e0b;font-family:inherit;font-size:13px;cursor:pointer;transition:all 0.2s;font-weight:600}
    .filter-tag:hover,.filter-tag.active{background:#f59e0b;color:#0a1628}

    .result-count{color:#888;font-size:14px;margin-bottom:16px}

    .trending-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(340px,1fr));gap:16px}
    .trend-card{background:#1c2333;border-radius:16px;overflow:hidden;border:1px solid rgba(245,158,11,0.1);transition:all 0.3s;text-decoration:none;color:inherit;display:block}
    .trend-card:hover{border-color:rgba(245,158,11,0.3);transform:translateY(-2px)}
    .trend-badge{display:inline-flex;align-items:center;gap:4px;padding:4px 10px;border-radius:8px;font-size:11px;font-weight:700;margin-bottom:8px}
    .badge-trending{background:rgba(245,158,11,0.15);color:#f59e0b}
    .badge-new{background:rgba(34,197,94,0.15);color:#22c55e}
    .badge-featured{background:rgba(168,85,247,0.15);color:#a855f7}
    .tcard-body{padding:16px 20px}
    .tcard-name{font-size:17px;font-weight:700;color:#e0e0e0;margin-bottom:2px}
    .tcard-name-en{font-size:12px;color:#888}
    .tcard-meta{display:flex;gap:12px;flex-wrap:wrap;margin-top:6px;font-size:13px;color:#888}
    .tcard-desc{font-size:13px;color:#aaa;margin-top:8px;line-height:1.6}
    .tcard-footer{display:flex;justify-content:space-between;align-items:center;padding:12px 20px;border-top:1px solid rgba(255,255,255,0.06);background:rgba(0,0,0,0.1)}
    .tcard-rating{display:flex;align-items:center;gap:4px;color:#f59e0b;font-weight:700}
    .tcard-price{color:#c9a84c;font-size:13px}
    .tcard-audiences{display:flex;gap:4px;flex-wrap:wrap}
    .audience-tag{font-size:11px;padding:2px 8px;border-radius:6px;background:rgba(201,168,76,0.08);color:#888}

    .loading{text-align:center;padding:60px;color:#888;font-size:18px}
    .footer{background:#0d1117;padding:30px 20px;text-align:center;color:#555;font-size:13px;border-top:1px solid rgba(201,168,76,0.1);margin-top:40px}
    .footer a{color:#c9a84c}

    @media(max-width:768px){
      .hero{padding:30px 16px 25px}
      .hero h2{font-size:1.5rem}
      .container{padding:16px}
      .controls{flex-direction:column}
      .search-input,.filter-select{width:100%}
      .trending-grid{grid-template-columns:1fr}
    }
  </style>
</head>
<body>
  <header class="header">
    <div class="header-inner">
      <a href="index.html" class="logo"><h1>ğŸ™ï¸ ÙˆÙŠÙ† Ù†Ø±ÙˆØ­</h1></a>
      <a href="index.html" class="back-link">â† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
    </div>
  </header>

  <section class="hero">
    <h2>ğŸ”¥ <span>Ø§Ù„Ø£Ù…Ø§ÙƒÙ† Ø§Ù„Ø±Ø§Ø¦Ø¬Ø©</span> ÙÙŠ Ø§Ù„Ø±ÙŠØ§Ø¶</h2>
    <p>Ø§Ù„Ø£Ù…Ø§ÙƒÙ† Ø§Ù„Ù„ÙŠ Ø§Ù„ÙƒÙ„ ÙŠØªÙƒÙ„Ù… Ø¹Ù†Ù‡Ø§ Ø§Ù„Ø­ÙŠÙ† â€” Ø§ÙƒØªØ´Ù ÙˆØ´ Ø§Ù„Ø¬Ø¯ÙŠØ¯ ÙˆØ§Ù„Ù„ÙŠ ÙŠØ³ØªØ§Ù‡Ù„ Ø§Ù„Ø²ÙŠØ§Ø±Ø©</p>
    <div class="stats-bar" id="heroStats"></div>
  </section>

  <div class="container">
    <div class="filter-tags" id="catTags"></div>
    <div class="controls">
      <input type="text" class="search-input" id="searchInput" placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…ÙƒØ§Ù† Ø±Ø§Ø¦Ø¬...">
      <select class="filter-select" id="sortSelect">
        <option value="trending">Ø§Ù„Ø£ÙƒØ«Ø± Ø±ÙˆØ§Ø¬Ø§Ù‹</option>
        <option value="newest">Ø§Ù„Ø£Ø­Ø¯Ø« Ø£ÙˆÙ„Ø§Ù‹</option>
        <option value="rating">Ø§Ù„Ø£Ø¹Ù„Ù‰ ØªÙ‚ÙŠÙŠÙ…Ø§Ù‹</option>
      </select>
    </div>
    <div class="result-count" id="resultCount"></div>
    <div id="loading" class="loading">â³ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</div>
    <div class="trending-grid" id="grid"></div>
  </div>

  <footer class="footer">
    <p>ğŸ”„ ÙŠØªÙ… ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø§Ø¦Ø¬ Ø¨Ø§Ø³ØªÙ…Ø±Ø§Ø±</p>
    <p style="margin-top:8px">ÙˆÙŠÙ† Ù†Ø±ÙˆØ­ Ø¨Ø§Ù„Ø±ÙŠØ§Ø¶ØŸ â€” <a href="index.html">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a> | <a href="best.html">Ø£ÙØ¶Ù„ Ø§Ù„Ø£Ù…Ø§ÙƒÙ†</a> | <a href="top-rated.html">Ø§Ù„Ø£Ø¹Ù„Ù‰ ØªÙ‚ÙŠÙŠÙ…Ø§Ù‹</a></p>
  </footer>

<script>
const toAr = n => n.toString().replace(/\d/g, d => 'Ù Ù¡Ù¢Ù£Ù¤Ù¥Ù¦Ù§Ù¨Ù©'[d]);
const CAT_EMOJIS = {'Ù…Ø·Ø¹Ù…':'ğŸ½ï¸','ÙƒØ§ÙÙŠÙ‡':'â˜•','ØªØ±ÙÙŠÙ‡':'ğŸ®','Ø­Ù„ÙˆÙŠØ§Øª':'ğŸ°','ØªØ³ÙˆÙ‚':'ğŸ›ï¸','Ø·Ø¨ÙŠØ¹Ø©':'ğŸŒ¿','ÙÙ†Ø§Ø¯Ù‚':'ğŸ¨','Ø´Ø§Ù„ÙŠÙ‡':'ğŸ¡','Ù…ÙˆÙ„Ø§Øª':'ğŸ¬','Ù…ØªØ§Ø­Ù':'ğŸ›ï¸','ÙØ¹Ø§Ù„ÙŠØ§Øª':'ğŸ­'};

let allPlaces = [];
let trendingPlaces = [];
let activeCat = '';

async function loadData() {
  try {
    allPlaces = await fetch('data/places-light.json').then(r => r.json());
    
    // Filter trending places (tr=1 means trending)
    trendingPlaces = allPlaces.filter(p => p.tr === 1 || p.nw === 1 || p.fr === 1);
    
    document.getElementById('loading').style.display = 'none';

    // Stats
    const trendCount = allPlaces.filter(p => p.tr).length;
    const newCount = allPlaces.filter(p => p.nw).length;
    document.getElementById('heroStats').innerHTML = `
      <div class="stat-item"><div class="num">${toAr(trendCount)}</div><div class="lbl">Ù…ÙƒØ§Ù† Ø±Ø§Ø¦Ø¬</div></div>
      <div class="stat-item"><div class="num">${toAr(newCount)}</div><div class="lbl">Ù…ÙƒØ§Ù† Ø¬Ø¯ÙŠØ¯</div></div>
      <div class="stat-item"><div class="num">${toAr(allPlaces.filter(p=>p.fr).length)}</div><div class="lbl">Ù…Ù…ÙŠØ²</div></div>
    `;

    // Category tags
    const cats = [...new Set(trendingPlaces.map(p => p.c).filter(Boolean))].sort();
    document.getElementById('catTags').innerHTML = `<button class="filter-tag active" data-cat="">ğŸ”¥ Ø§Ù„ÙƒÙ„</button>` +
      cats.map(c => `<button class="filter-tag" data-cat="${c}">${CAT_EMOJIS[c]||''} ${c}</button>`).join('');

    document.querySelectorAll('.filter-tag').forEach(tag => {
      tag.addEventListener('click', () => {
        document.querySelectorAll('.filter-tag').forEach(t => t.classList.remove('active'));
        tag.classList.add('active');
        activeCat = tag.dataset.cat;
        render();
      });
    });

    render();
  } catch(e) {
    document.getElementById('loading').innerHTML = 'âŒ Ø®Ø·Ø£: ' + e.message;
  }
}

function render() {
  const query = document.getElementById('searchInput').value.trim().toLowerCase();
  const sort = document.getElementById('sortSelect').value;

  let filtered = trendingPlaces.filter(p => {
    if (activeCat && p.c !== activeCat) return false;
    if (query && !(p.n||'').includes(query) && !(p.ne||'').toLowerCase().includes(query) && !(p.h||'').includes(query)) return false;
    return true;
  });

  // Sort
  if (sort === 'rating') filtered.sort((a,b) => (b.r||0) - (a.r||0));
  else if (sort === 'newest') filtered.sort((a,b) => (b.nw||0) - (a.nw||0) || (b.r||0) - (a.r||0));
  else filtered.sort((a,b) => {
    // Trending first, then featured, then new, then by rating
    const aScore = (a.tr?3:0) + (a.fr?2:0) + (a.nw?1:0);
    const bScore = (b.tr?3:0) + (b.fr?2:0) + (b.nw?1:0);
    return bScore - aScore || (b.r||0) - (a.r||0);
  });

  document.getElementById('resultCount').textContent = `Ø¹Ø±Ø¶ ${toAr(filtered.length)} Ù…ÙƒØ§Ù† Ø±Ø§Ø¦Ø¬`;

  document.getElementById('grid').innerHTML = filtered.slice(0, 100).map(p => `<a href="place.html?id=${p.id}" class="trend-card">
    <div class="tcard-body">
      <div>
        ${p.tr ? '<span class="trend-badge badge-trending">ğŸ”¥ Ø±Ø§Ø¦Ø¬</span>' : ''}
        ${p.nw ? '<span class="trend-badge badge-new">ğŸ†• Ø¬Ø¯ÙŠØ¯</span>' : ''}
        ${p.fr ? '<span class="trend-badge badge-featured">â­ Ù…Ù…ÙŠØ²</span>' : ''}
      </div>
      <div class="tcard-name">${p.n}</div>
      ${p.ne ? `<div class="tcard-name-en">${p.ne}</div>` : ''}
      <div class="tcard-meta">
        <span>${CAT_EMOJIS[p.c]||''} ${p.c || 'Ø£Ø®Ø±Ù‰'}</span>
        <span>ğŸ“ ${p.h || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</span>
      </div>
      ${p.d ? `<div class="tcard-desc">${p.d.substring(0,100)}${p.d.length>100?'...':''}</div>` : ''}
      ${p.au?.length ? `<div class="tcard-audiences" style="margin-top:8px">${p.au.map(a=>`<span class="audience-tag">${a}</span>`).join('')}</div>` : ''}
    </div>
    <div class="tcard-footer">
      <div class="tcard-rating">${p.r ? `â­ ${p.r}` : 'Ø¨Ø¯ÙˆÙ† ØªÙ‚ÙŠÙŠÙ…'}</div>
      ${p.p ? `<div class="tcard-price">${p.p}</div>` : ''}
    </div>
  </a>`).join('');
}

document.getElementById('searchInput').addEventListener('input', render);
document.getElementById('sortSelect').addEventListener('change', render);

loadData();
</script>
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/riyadh-places/sw.js').catch(() => {});
    }
  </script>
</body>
</html>
